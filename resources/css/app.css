@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
    :root {
        --bg-base: #19181a;
        --bg-surface: #221f22;
        --bg-surface-strong: #2d2a2c;
        --border-surface: #403e41;
        --ink: #fcfcfa;
        --ink-muted: #aaa4a8;
        --ink-subtle: #817b80;
        --accent: #a5d774;
        --danger: #ee5c81;
        --ok: #56b982;
        --notify: #dfbe5a;
        --button-on-accent: #19181a;
        --button-on-danger: #19181a;
        --bg-radial-a: rgb(64 62 65 / 32%);
        --bg-radial-b: rgb(45 42 44 / 45%);
        --bg-gradient-mid: #1d1b1d;
        --page-radial-a: rgb(64 62 65 / 52%);
        --page-radial-b: rgb(45 42 44 / 55%);
        --page-radial-c: rgb(34 31 34 / 62%);
        --card-gradient: linear-gradient(145deg, rgb(45 42 44 / 92%), rgb(34 31 34 / 96%));
        --card-shadow:
            0 24px 46px -34px rgb(0 0 0 / 80%),
            inset 0 1px 0 rgb(255 255 255 / 3%);
        --panel-shadow: 0 14px 24px -22px rgb(0 0 0 / 80%);
        --selection-bg: rgb(165 215 116 / 28%);
        --selection-ink: #19181a;
        --input-hover-border: rgb(252 252 250 / 34%);
        --input-focus-border: rgb(252 252 250 / 62%);
        --input-focus-ring: rgb(252 252 250 / 8%);
        --button-primary-shadow: 0 16px 22px -16px rgb(165 215 116 / 75%);
        --button-danger-shadow: 0 16px 22px -16px rgb(238 92 129 / 72%);
        --button-focus-ring: rgb(252 252 250 / 14%);
        --link-hover: #b8e68d;
        --status-border: rgb(165 215 116 / 45%);
        --status-bg: rgb(165 215 116 / 14%);
        --auth-focus-border: rgb(252 252 250 / 48%);
    }

    :root[data-theme='light'] {
        /* Requested light palette */
        --bg: #ebebeb;
        --bg-elevated: #ffffff;
        --bg-soft: #f9f9f9;
        --border-subtle: #e7e7e7;
        --border-strong: #dbdbdb;
        --text-primary: #0d0d0d;
        --text-secondary: #5d5d5d;
        --accent: #2563eb;
        --accent-soft: #dbeafe;
        --accent-strong: #1d4ed8;
        --danger: #dc2626;
        --muted: #9ca3af;
        --message-in: #ffffff;
        --message-out: #eef0f4;
        --scroll-track: #e6e9ef;
        --scroll-thumb: #c8ccd6;
        --notify: #f97316;
        --ok: #16a34a;
        --bad: #dc2626;
        --app-viewport-height: 100vh;
        --app-header-height: 0px;
        --panel-header-padding: 0.75rem;
        --list-rhythm: 0.75rem;
        --btn-border-neutral: color-mix(in srgb, var(--border-subtle) 80%, var(--bg-elevated) 20%);
        --focus-outline: 2px solid var(--accent);
        --radius-sm: 0.55rem;
        --radius-md: 0.7rem;
        --radius-lg: 0.85rem;
        --radius-xl: 1rem;
        --radius-pill: 0.45rem;
        --saber-blade-bg: var(--bg-elevated);
        --saber-blade-border: #d7dde7;
        --saber-text: #0b2b14;
        --saber-text-muted: #0f3a1c;

        /* Aliases for existing app tokens */
        --bg-base: var(--bg);
        --bg-surface: var(--bg-elevated);
        --bg-surface-strong: var(--bg-soft);
        --border-surface: var(--border-strong);
        --ink: var(--text-primary);
        --ink-muted: var(--text-secondary);
        --ink-subtle: #7f7b7e;
        --button-on-accent: #ffffff;
        --button-on-danger: #ffffff;
        --bg-radial-a: rgb(141 174 229 / 30%);
        --bg-radial-b: rgb(203 216 237 / 42%);
        --bg-gradient-mid: #e6e6e6;
        --page-radial-a: rgb(187 204 234 / 48%);
        --page-radial-b: rgb(208 219 238 / 54%);
        --page-radial-c: rgb(231 236 245 / 68%);
        --card-gradient: linear-gradient(145deg, rgb(255 255 255 / 98%), rgb(249 249 249 / 96%));
        --card-shadow:
            0 24px 46px -34px rgb(15 23 42 / 18%),
            inset 0 1px 0 rgb(255 255 255 / 80%);
        --panel-shadow: 0 14px 24px -22px rgb(15 23 42 / 20%);
        --selection-bg: rgb(37 99 235 / 24%);
        --selection-ink: #ffffff;
        --input-hover-border: rgb(37 99 235 / 30%);
        --input-focus-border: rgb(37 99 235 / 62%);
        --input-focus-ring: rgb(37 99 235 / 14%);
        --button-primary-shadow: 0 16px 22px -16px rgb(37 99 235 / 45%);
        --button-danger-shadow: 0 16px 22px -16px rgb(220 38 38 / 40%);
        --button-focus-ring: rgb(37 99 235 / 24%);
        --link-hover: var(--accent-strong);
        --status-border: rgb(22 163 74 / 35%);
        --status-bg: rgb(22 163 74 / 12%);
        --auth-focus-border: rgb(37 99 235 / 48%);
    }

    html,
    body,
    #app {
        width: 100%;
        min-height: 100%;
        overflow-x: hidden;
    }

    body {
        margin: 0;
        font-family: 'Manrope', 'Segoe UI', sans-serif;
        color: var(--ink);
        background:
            radial-gradient(1100px 620px at -12% -14%, var(--bg-radial-a), transparent 58%),
            radial-gradient(980px 560px at 112% -16%, var(--bg-radial-b), transparent 52%),
            linear-gradient(180deg, var(--bg-base) 0%, var(--bg-gradient-mid) 42%, var(--bg-surface) 100%);
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        font-family: 'Space Grotesk', 'Manrope', 'Segoe UI', sans-serif;
        letter-spacing: -0.015em;
    }

    ::selection {
        background: var(--selection-bg);
        color: var(--selection-ink);
    }

    /* iOS Safari focus-zoom fix: keep form controls at 16px+ */
    @supports (-webkit-touch-callout: none) {
        input,
        textarea,
        select {
            font-size: 16px !important;
        }
    }

    button,
    [role='button'] {
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
    }

    button:not(:disabled),
    [role='button'] {
        transition: transform 0.14s ease, filter 0.14s ease, opacity 0.14s ease;
    }

    button:not(:disabled):active,
    [role='button']:active {
        transform: none;
        filter: brightness(0.98);
    }

    @media (prefers-reduced-motion: reduce) {
        button:not(:disabled),
        [role='button'] {
            transition-duration: 0.01ms;
        }
    }
}

@layer components {
    .app-page {
        position: relative;
        min-height: 100vh;
        isolation: isolate;
    }

    .app-page::before {
        content: '';
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: -1;
        background:
            radial-gradient(430px 300px at 16% 15%, var(--page-radial-a), transparent 72%),
            radial-gradient(500px 360px at 84% 21%, var(--page-radial-b), transparent 75%),
            radial-gradient(460px 340px at 50% 94%, var(--page-radial-c), transparent 75%);
    }

    .app-shell {
        width: min(100%, 460px);
        margin-inline: auto;
        padding: 1.25rem;
    }

    .app-card {
        border-radius: 1.5rem;
        border: 1px solid var(--border-surface);
        background: var(--card-gradient);
        box-shadow: var(--card-shadow);
    }

    .app-panel {
        border-radius: 1.1rem;
        border: 1px solid var(--border-surface);
        background: var(--bg-surface-strong);
        box-shadow: var(--panel-shadow);
    }

    .app-brand {
        font-family: 'Space Grotesk', 'Manrope', sans-serif;
        font-weight: 700;
        letter-spacing: 0.08em;
        text-transform: uppercase;
    }

    .app-kicker {
        color: var(--ink-muted);
        font-size: 0.75rem;
        line-height: 1rem;
        text-transform: uppercase;
        letter-spacing: 0.18em;
    }

    .app-title {
        color: var(--ink);
        font-size: 1.85rem;
        line-height: 1.15;
        margin: 0;
        font-weight: 700;
    }

    .app-subtitle {
        margin-top: 0.5rem;
        color: var(--ink-muted);
        font-size: 0.95rem;
        line-height: 1.45;
    }

    .app-label {
        display: block;
        margin-bottom: 0.45rem;
        color: var(--ink-muted);
        font-size: 0.82rem;
        font-weight: 600;
    }

    .app-input {
        width: 100%;
        border-radius: 0.9rem;
        border: 1px solid var(--border-surface);
        background: var(--bg-surface-strong);
        color: var(--ink);
        font-size: 0.95rem;
        line-height: 1.3;
        padding: 0.7rem 0.85rem;
        transition: border-color 0.2s ease, box-shadow 0.2s ease, transform 0.2s ease;
    }

    .app-input::placeholder {
        color: var(--ink-subtle);
    }

    .app-input:hover {
        border-color: var(--input-hover-border);
    }

    .app-input:focus {
        outline: none;
        border-color: var(--input-focus-border);
        box-shadow:
            0 0 0 4px var(--input-focus-ring),
            0 10px 24px -20px rgb(0 0 0 / 24%);
        transform: translateY(-1px);
    }

    .app-button-primary,
    .app-button-secondary,
    .app-button-danger {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border-radius: 0.9rem;
        border: 1px solid transparent;
        padding: 0.68rem 1rem;
        font-size: 0.82rem;
        font-weight: 700;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease, border-color 0.2s ease;
    }

    .app-pressable {
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
        transition: transform 0.14s ease, filter 0.14s ease, opacity 0.14s ease;
    }

    .app-pressable:active {
        transform: none;
        filter: brightness(0.98);
    }

    .app-button-primary {
        color: var(--button-on-accent);
        background: var(--accent);
        box-shadow: var(--button-primary-shadow);
    }

    .app-button-secondary {
        color: var(--ink);
        background: var(--bg-surface-strong);
        border-color: var(--border-surface);
    }

    .app-button-danger {
        color: var(--button-on-danger);
        background: var(--danger);
        box-shadow: var(--button-danger-shadow);
    }

    .app-button-primary:hover,
    .app-button-secondary:hover,
    .app-button-danger:hover {
        transform: translateY(-1px);
        filter: brightness(1.03);
    }

    .app-button-primary:active,
    .app-button-secondary:active,
    .app-button-danger:active {
        transform: none;
        filter: brightness(0.98);
    }

    .app-button-primary:focus-visible,
    .app-button-secondary:focus-visible,
    .app-button-danger:focus-visible {
        outline: none;
        box-shadow:
            0 0 0 4px var(--button-focus-ring),
            0 16px 20px -16px rgba(0, 0, 0, 0.9);
    }

    .app-button-primary:disabled,
    .app-button-secondary:disabled,
    .app-button-danger:disabled {
        transform: none;
        opacity: 0.58;
        cursor: not-allowed;
        filter: grayscale(0.05);
    }

    .app-link {
        color: var(--accent);
        text-decoration: underline;
        text-decoration-thickness: 1px;
        text-underline-offset: 3px;
        transition: color 0.2s ease;
    }

    .app-link:hover {
        color: var(--link-hover);
    }

    .app-link:active {
        opacity: 0.8;
    }

    .app-muted {
        color: var(--ink-muted);
    }

    .app-status {
        border-radius: 0.85rem;
        padding: 0.6rem 0.8rem;
        border: 1px solid var(--status-border);
        background: var(--status-bg);
        color: var(--accent);
        font-size: 0.86rem;
    }

    .app-error {
        margin-top: 0.4rem;
        color: var(--danger);
        font-size: 0.78rem;
    }

    .auth-quiet .app-input {
        transition: border-color 0.15s ease, background-color 0.15s ease, color 0.15s ease;
    }

    .auth-quiet .app-input:hover {
        border-color: var(--border-surface);
    }

    .auth-quiet .app-input:focus {
        border-color: var(--auth-focus-border);
        box-shadow: none;
        transform: none;
    }

    .auth-quiet .app-button-primary,
    .auth-quiet .app-button-secondary,
    .auth-quiet .app-button-danger {
        transition: border-color 0.15s ease, background-color 0.15s ease, color 0.15s ease;
        box-shadow: none;
    }

    .auth-quiet .app-button-primary:hover,
    .auth-quiet .app-button-secondary:hover,
    .auth-quiet .app-button-danger:hover {
        transform: none;
        filter: none;
    }

    .auth-quiet .app-button-primary:active,
    .auth-quiet .app-button-secondary:active,
    .auth-quiet .app-button-danger:active {
        transform: none;
        filter: none;
        opacity: 0.92;
    }

    .auth-quiet .app-button-primary:focus-visible,
    .auth-quiet .app-button-secondary:focus-visible,
    .auth-quiet .app-button-danger:focus-visible {
        box-shadow: none;
    }

    .auth-flat-page {
        background: var(--bg-base);
    }

    .auth-flat-page::before {
        display: none;
        background: none;
    }

    .auth-flat-page .auth-flat-card {
        background: var(--bg-surface);
        border-color: var(--border-surface);
        box-shadow: none;
        color: var(--ink);
    }

    .auth-flat-page .auth-flat-card .app-brand {
        color: var(--ink);
    }

    .auth-flat-page .auth-flat-card .auth-flat-card-meta {
        color: var(--ink-muted);
    }

    .auth-flat-page .app-button-primary {
        background: var(--accent);
        box-shadow: none;
    }

    .auth-flat-page .app-button-primary:hover,
    .auth-flat-page .app-button-primary:active {
        filter: none;
    }

    @media (prefers-reduced-motion: reduce) {
        .app-button-primary,
        .app-button-secondary,
        .app-button-danger,
        .app-pressable {
            transition-duration: 0.01ms;
        }
    }
}

/* Dashboard color-token remap for light mode (Tailwind arbitrary dark classes). */
:root[data-theme='light'] .bg-\[\#19181a\] { background-color: var(--bg-base) !important; }
:root[data-theme='light'] .bg-\[\#19181a\]\/78 { background-color: rgb(13 13 13 / 46%) !important; }
:root[data-theme='light'] .bg-\[\#19181a\]\/90 { background-color: rgb(13 13 13 / 58%) !important; }
:root[data-theme='light'] .bg-\[\#221f22\] { background-color: var(--bg-surface) !important; }
:root[data-theme='light'] .bg-\[\#221f22\]\/95 { background-color: rgb(255 255 255 / 95%) !important; }
:root[data-theme='light'] .bg-\[\#221f22\]\/96 { background-color: rgb(255 255 255 / 96%) !important; }
:root[data-theme='light'] .bg-\[\#2d2a2c\] { background-color: var(--bg-surface-strong) !important; }
:root[data-theme='light'] .bg-\[\#343033\] { background-color: #ececec !important; }
:root[data-theme='light'] .bg-\[\#403e41\] { background-color: var(--border-strong) !important; }
:root[data-theme='light'] .bg-\[\#56b982\] { background-color: var(--ok) !important; }
:root[data-theme='light'] .bg-\[\#5b7fff\]\/12 { background-color: rgb(37 99 235 / 12%) !important; }
:root[data-theme='light'] .bg-\[\#5b7fff\]\/18 { background-color: rgb(37 99 235 / 18%) !important; }
:root[data-theme='light'] .bg-\[\#a5d774\]\/15 { background-color: rgb(22 163 74 / 15%) !important; }
:root[data-theme='light'] .bg-\[\#a5d774\]\/20 { background-color: rgb(22 163 74 / 20%) !important; }
:root[data-theme='light'] .bg-\[\#dd6e6e\] { background-color: rgb(220 38 38 / 38%) !important; }
:root[data-theme='light'] .bg-\[\#dfbe5a\] { background-color: rgb(234 179 8 / 42%) !important; }
:root[data-theme='light'] .bg-\[\#ee5c81\]\/12 { background-color: rgb(220 38 38 / 12%) !important; }
:root[data-theme='light'] .bg-\[\#ee5c81\]\/14 { background-color: rgb(220 38 38 / 14%) !important; }
:root[data-theme='light'] .bg-\[\#ee5c81\]\/15 { background-color: rgb(220 38 38 / 15%) !important; }
:root[data-theme='light'] .bg-\[\#ee5c81\]\/18 { background-color: rgb(220 38 38 / 18%) !important; }
:root[data-theme='light'] .bg-\[\#ee5c81\]\/20 { background-color: rgb(220 38 38 / 20%) !important; }
:root[data-theme='light'] .bg-\[\#fcfcfa\] { background-color: #ffffff !important; }
:root[data-theme='light'] .hover\:bg-\[\#2d2a2c\]:hover { background-color: var(--bg-surface-strong) !important; }
:root[data-theme='light'] .hover\:bg-\[\#ee5c81\]\/18:hover { background-color: rgb(220 38 38 / 18%) !important; }
:root[data-theme='light'] .hover\:bg-\[\#f1f1ef\]:hover { background-color: #f3f5f8 !important; }

:root[data-theme='light'] .text-\[\#19181a\] { color: var(--text-primary) !important; }
:root[data-theme='light'] .text-\[\#6e6a6d\] { color: #6c676b !important; }
:root[data-theme='light'] .text-\[\#7f7b7e\] { color: #797276 !important; }
:root[data-theme='light'] .text-\[\#9f9a9d\] { color: #6b6570 !important; }
:root[data-theme='light'] .text-\[\#a5d774\] { color: var(--ok) !important; }
:root[data-theme='light'] .text-\[\#bcb7ba\] { color: #635f62 !important; }
:root[data-theme='light'] .text-\[\#d8e7ff\] { color: var(--accent-strong) !important; }
:root[data-theme='light'] .text-\[\#ee5c81\] { color: var(--danger) !important; }
:root[data-theme='light'] .text-\[\#fcfcfa\] { color: var(--text-primary) !important; }
:root[data-theme='light'] .hover\:text-\[\#fcfcfa\]:hover { color: var(--text-primary) !important; }
:root[data-theme='light'] .placeholder\:text-\[\#7f7b7e\]::placeholder { color: #797276 !important; }

:root[data-theme='light'] .border-\[\#403e41\] { border-color: var(--border-surface) !important; }
:root[data-theme='light'] .border-\[\#5b7fff\] { border-color: var(--accent) !important; }
:root[data-theme='light'] .border-\[\#5b7fff\]\/40 { border-color: rgb(37 99 235 / 40%) !important; }
:root[data-theme='light'] .border-\[\#5b7fff\]\/70 { border-color: rgb(37 99 235 / 70%) !important; }
:root[data-theme='light'] .border-\[\#6d696c\] { border-color: #bab5b9 !important; }
:root[data-theme='light'] .border-\[\#a5d774\]\/40 { border-color: rgb(22 163 74 / 40%) !important; }
:root[data-theme='light'] .border-\[\#a5d774\]\/55 { border-color: rgb(22 163 74 / 55%) !important; }
:root[data-theme='light'] .border-\[\#ee5c81\]\/40 { border-color: rgb(220 38 38 / 40%) !important; }
:root[data-theme='light'] .border-\[\#ee5c81\]\/55 { border-color: rgb(220 38 38 / 55%) !important; }
:root[data-theme='light'] .border-\[\#ee5c81\]\/60 { border-color: rgb(220 38 38 / 60%) !important; }
:root[data-theme='light'] .border-\[\#fcfcfa\] { border-color: rgb(13 13 13 / 62%) !important; }
:root[data-theme='light'] .border-\[\#fcfcfa\]\/45 { border-color: rgb(13 13 13 / 45%) !important; }
:root[data-theme='light'] .border-\[\#fcfcfa\]\/80 { border-color: rgb(13 13 13 / 80%) !important; }
:root[data-theme='light'] .focus\:border-\[\#fcfcfa\]\/45:focus { border-color: rgb(13 13 13 / 45%) !important; }
:root[data-theme='light'] .hover\:border-\[\#6d696c\]:hover { border-color: #bab5b9 !important; }
:root[data-theme='light'] .hover\:border-\[\#ee5c81\]:hover { border-color: var(--danger) !important; }
:root[data-theme='light'] .hover\:border-\[\#fcfcfa\]:hover { border-color: rgb(13 13 13 / 62%) !important; }
:root[data-theme='light'] .hover\:border-\[\#fcfcfa\]\/35:hover { border-color: rgb(13 13 13 / 35%) !important; }
:root[data-theme='light'] .hover\:border-\[\#fcfcfa\]\/40:hover { border-color: rgb(13 13 13 / 40%) !important; }
:root[data-theme='light'] .hover\:border-\[\#fcfcfa\]\/45:hover { border-color: rgb(13 13 13 / 45%) !important; }

:root[data-theme='light'] .decoration-\[\#6e6a6d\] { text-decoration-color: #6c676b !important; }

@layer utilities {
    .animate-rise {
        animation: rise-in 0.52s cubic-bezier(0.2, 0.8, 0.2, 1) both;
    }

    .animate-pop {
        animation: pop-in 0.45s cubic-bezier(0.16, 1, 0.3, 1) both;
    }

    .stagger-1 {
        animation-delay: 0.08s;
    }

    .stagger-2 {
        animation-delay: 0.16s;
    }

    .stagger-3 {
        animation-delay: 0.24s;
    }
}

@keyframes rise-in {
    from {
        opacity: 0;
        transform: translate3d(0, 12px, 0);
    }
    to {
        opacity: 1;
        transform: translate3d(0, 0, 0);
    }
}

@keyframes pop-in {
    from {
        opacity: 0;
        transform: scale(0.98) translate3d(0, 6px, 0);
    }
    to {
        opacity: 1;
        transform: scale(1) translate3d(0, 0, 0);
    }
}
